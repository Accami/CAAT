<!DOCTYPE HTML>
<html>
<head>

</head>
<body>

<script src="../../../src/Core/ModuleManager.js"></script>
<script type="text/javascript">
    /**
     * @license
     *
     * The MIT License
     * Copyright (c) 2010-2011 Ibon Tolosana, Hyperandroid || http://labs.hyperandroid.com/

     * Permission is hereby granted, free of charge, to any person obtaining a copy
     * of this software and associated documentation files (the "Software"), to deal
     * in the Software without restriction, including without limitation the rights
     * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
     * copies of the Software, and to permit persons to whom the Software is
     * furnished to do so, subject to the following conditions:

     * The above copyright notice and this permission notice shall be included in
     * all copies or substantial portions of the Software.

     * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
     * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
     * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
     * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
     * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
     * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
     * THE SOFTWARE.
     *
     */

    (function() {

        window.addEventListener('load',load,false);

        function load() {
            CAAT.ModuleManager.
                    debug(true).

                    baseURL("../../../src/").
                    setModulePath("CAAT.Core",              "Core").
                    setModulePath("CAAT.Math",              "Math").
                    setModulePath("CAAT.Behavior",          "Behavior").
                    setModulePath("CAAT.Foundation",        "Foundation").
                    setModulePath("CAAT.Event",             "Event").
                    setModulePath("CAAT.PathUtil",          "PathUtil").
                    setModulePath("CAAT.Module",            "Modules").
                    setModulePath("CAAT.Module.Preloader",  "Modules/Image/Preloader").
                    setModulePath("CAAT.WebGL",             "WebGL").

                // get modules, and solve their dependencies.
                    bring(
                    [
                        "CAAT.PathUtil.Path",
                        "CAAT.Foundation.Director",
                        "CAAT.Foundation.Scene",
                        "CAAT.Foundation.UI.PathActor",
                        "CAAT.Foundation.UI.InterpolatorActor",
                        "CAAT.Foundation.UI.TextActor",
                        "CAAT.Foundation.UI.Dock",
                        "CAAT.Module.Preloader.Preloader",
                        "CAAT.Module.Preloader.XHR",
                        "CAAT.Module.Skeleton.Skeleton",
                        "CAAT.Module.Skeleton.SkeletonActor"
                    ]).

                // this function will be firer every time all dependencies have been solved.
                // if you call again bring, this function could be fired again.
                    onReady( function() {
                        ffl();
                    } );


        }

        function ffl() {

            new CAAT.Module.Preloader.Preloader().

                    setBaseURL("dragon/").
                        addElement( "back", "back.png").
                        addElement( "chest", "chest.png").
                        addElement( "chin", "chin.png").
                        addElement( "front_toeA", "front_toeA.png").
                        addElement( "front_toeB", "front_toeB.png").
                        addElement( "head", "head.png").
                        addElement( "L_front_leg", "L_front_leg.png").
                        addElement( "L_front_thigh", "L_front_thigh.png").
                        addElement( "L_rear_leg", "L_rear_leg.png").
                        addElement( "L_rear_thigh", "L_rear_thigh.png").
                        addElement( "L_wing01", "L_wing01.png").
                        addElement( "L_wing02", "L_wing02.png").
                        addElement( "L_wing03", "L_wing03.png").
                        addElement( "L_wing04", "L_wing04.png").
                        addElement( "L_wing05", "L_wing05.png").
                        addElement( "L_wing06", "L_wing06.png").
                        addElement( "L_wing07", "L_wing07.png").
                        addElement( "L_wing08", "L_wing08.png").
                        addElement( "L_wing09", "L_wing09.png").
                        addElement( "R_front_leg",  "R_front_leg.png").
                        addElement( "R_front_thigh","R_front_thigh.png").
                        addElement( "R_rear_leg",   "R_rear_leg.png").
                        addElement( "R_rear_thigh", "R_rear_thigh.png").
                        addElement( "R_wing01",     "R_wing01.png").
                        addElement( "R_wing02",     "R_wing02.png").
                        addElement( "R_wing03",     "R_wing03.png").
                        addElement( "R_wing04",     "R_wing04.png").
                        addElement( "R_wing05",     "R_wing05.png").
                        addElement( "R_wing06",     "R_wing06.png").
                        addElement( "R_wing07",     "R_wing07.png").
                        addElement( "R_wing08",     "R_wing08.png").
                        addElement( "R_wing09",     "R_wing09.png").
                        addElement( "rear-toe",     "rear-toe.png").
                        addElement( "tail01",     "tail01.png").
                        addElement( "tail02",     "tail02.png").
                        addElement( "tail03",     "tail03.png").
                        addElement( "tail04",     "tail04.png").
                        addElement( "tail05",     "tail05.png").
                        addElement( "tail06",     "tail06.png").

                    load( function(images) {
                        ff( images );
                    });
        }

        function ff( images ) {

            CAAT.DEBUG=1;

            var director = new CAAT.Director().initialize(900,700);
            director.setImagesCache(images);
            var scene=     director.createScene();

            var skeletondragon= new CAAT.Module.Skeleton.Skeleton().
                    setSkeletonFromFile("dragon/dragon-skeleton.json").
                    addAnimationFromFile( "default", "dragon/dragon-flying.json" );

            var skeletonActordragon = new CAAT.Module.Skeleton.SkeletonActor(director, skeletondragon).
                    setLocation( 500, 400).
                    setScale(.7,.7).
                    setAnimation("default", 4000);
            scene.addChild(skeletonActordragon);

            director.loop(1);
        }

    })();

</script>

</body>

</html>